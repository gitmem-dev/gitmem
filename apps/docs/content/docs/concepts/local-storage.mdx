---
title: Local Storage
description: How GitMem uses the local filesystem, what persists across sessions, and container deployment considerations.
---

import { Callout } from 'fumadocs-ui/components/callout'

# Local Storage

GitMem writes to the local filesystem for session state, caching, and free-tier data storage. This page maps exactly what lives where so you can make informed decisions about persistence — especially in containers.

## Storage Locations

| Location | What | Owner |
|----------|------|-------|
| `<project>/.gitmem/` | Session state, threads, config, caches | GitMem MCP server |
| `~/.cache/gitmem/` | Search result cache (15-min TTL) | GitMem MCP server |

## File Inventory

```
.gitmem/
+-- active-sessions.json          # Process lifecycle
+-- config.json                   # Project defaults
+-- sessions.json                 # Recent session index (free tier SOT)
+-- threads.json                  # Thread state cache / free tier SOT
+-- suggested-threads.json        # AI-suggested threads
+-- closing-payload.json          # (ephemeral -- deleted after use)
+-- cache/
|   +-- hook-scars.json           # Local scar copy for hooks plugin
+-- hooks-state/
|   +-- start_time                # Session start timestamp
|   +-- tool_call_count           # Recall nag counter
|   +-- last_nag_time             # Last recall reminder time
|   +-- stop_hook_active          # Lock file (re-entrancy guard)
|   +-- audit.jsonl               # Hook execution log
+-- sessions/
    +-- <session-uuid>/
        +-- session.json          # Per-session state (scars, confirmations)
```

**Total typical footprint: ~530KB** (dominated by `cache/hook-scars.json`).

## File Lifecycle

| File | Created | Survives Session Close? |
|------|---------|------------------------|
| `active-sessions.json` | `session_start` | Yes — multi-session registry |
| `config.json` | First `session_start` | Yes |
| `sessions.json` | `session_close` (free tier) | Yes |
| `threads.json` | `session_close` | Yes |
| `suggested-threads.json` | `session_close` | Yes |
| `closing-payload.json` | Agent writes before close | **No** — ephemeral |
| `cache/hook-scars.json` | Hooks plugin startup | Yes |
| `sessions/<id>/session.json` | `session_start` | **No** — cleaned up on close |

## Cross-Session Data Flow

### What `session_start` loads

| Data | Pro/Dev Source | Free Source |
|------|---------------|-------------|
| Last session (decisions, reflection) | Supabase `sessions` | `.gitmem/sessions.json` |
| Open threads | Supabase `threads` | `.gitmem/threads.json` |
| Recent decisions | Supabase `decisions` | `.gitmem/sessions.json` (embedded) |
| Scars for recall | Supabase `learnings` | `.gitmem/learnings.json` |
| Suggested threads | `.gitmem/suggested-threads.json` | `.gitmem/suggested-threads.json` |

### What `recall` searches

| Tier | Source | Search Method |
|------|--------|---------------|
| Pro/Dev | Supabase `learnings` | Semantic (embedding cosine similarity) |
| Pro/Dev (cached) | `~/.cache/gitmem/results/` | Local vector search (15-min TTL) |
| Free | `.gitmem/learnings.json` | Keyword tokenization match |

### What `session_close` persists

| Data | Pro/Dev Destination | Free Destination |
|------|--------------------|--------------------|
| Session record | Supabase `sessions` | `.gitmem/sessions.json` |
| New learnings | Supabase `learnings` | `.gitmem/learnings.json` |
| Decisions | Supabase `decisions` | `.gitmem/decisions.json` |
| Thread state | Supabase `threads` + local | `.gitmem/threads.json` |
| Scar usage | Supabase `scar_usage` | `.gitmem/scar_usage.json` |
| Transcript | Supabase storage bucket | Not captured |

## Container Deployments

### Ephemeral container per session

```
Container A (session 1) -> writes .gitmem/ -> container destroyed
Container B (session 2) -> fresh .gitmem/ -> no history
```

| Tier | Cross-Session Memory | What Breaks |
|------|---------------------|-------------|
| **Pro/Dev** | **Works** — Supabase is SOT | Hooks plugin cold-starts each time. Suggested threads lost. Minor UX friction, no data loss. |
| **Free** | **Completely broken** — all memory is local files | No scars, no threads, no session history. Each session is amnesic. |

### Persistent volume mount

```bash
docker run -v gitmem-data:/app/.gitmem ...
```

Both tiers work. Free tier: local files ARE the SOT. Pro tier: local files are caches, Supabase is SOT.

### Shared container (long-running)

Container stays alive across multiple `claude` invocations. Both tiers work. `.gitmem/` persists because the container persists.

## Recommendations

### Free tier

Mount a volume for `.gitmem/`:

```yaml
volumes:
  - gitmem-state:/workspace/.gitmem
```

Files that MUST persist: `learnings.json`, `threads.json`, `sessions.json`, `decisions.json`.

### Pro/Dev tier

**Nothing required.** Supabase is the source of truth. A fresh `.gitmem/` each session works — just slightly slower (cache cold start).

Optional for better UX:

```yaml
volumes:
  - gitmem-cache:/workspace/.gitmem/cache  # Avoids scar cache re-download
```

<Callout type="info" title="Why local files exist at all on pro tier">
`active-sessions.json` tracks process lifecycle (PIDs, hostnames) — inherently local. `sessions/<id>/session.json` survives context compaction when the LLM loses state. `cache/hook-scars.json` is needed by shell-based hooks that can't call Supabase directly. `closing-payload.json` avoids MCP tool call size limits.
</Callout>
